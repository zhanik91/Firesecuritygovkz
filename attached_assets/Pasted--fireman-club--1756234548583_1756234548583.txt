Что частично/не сделано (где ещё дожимать)

Печать «как у fireman.club»: сейчас есть кнопка печати и базовые «Обоснование/Формулы», но нет единого «паспорт расчёта» с:

обложкой (логотип, калькулятор, дата/версия),

пошаговой формулой с подстановкой чисел,

пронумерованными ссылками на НПА РК (с якорями на методичку),

принудительными переносами страниц (A4), оглавлением, шапкой/подвалом.
print.css есть, но не подключён.

Эвакуация:

Нет проверки максимальных расстояний до выхода по типу здания (мгновенный алерт «превышено»).

Нет режима нескольких выходов (распределение потока).

Минимальные ширины отображаются, но «красный» алерт при <0,8 м не выводится.

Категории А/Б/В/Г/Д:

Нужна нормативная логика по давлению ≥5 кПа (с учётом количества вещества и объёма помещения) и корректное отнесение в А (сейчас — упрощённая экспертная эвристика).

Отдельная обработка кейса Д (полное отсутствие горючих — выводить явно).

Кнопка «Очистить всё» для длинного списка веществ — желательно.

НГПС:

Проверить и дополнить перечень «обязательных» отраслей по Постановлению №1017 (не только нефтегаз/химия/энергетика).

Подсказки к полям: «площадь суммарно по А/Б/В», «расстояние по прямой до ближайшей ПЧ МЧС» — есть частично, можно сделать понятнее.

SEO:

Применить SEOHead на AdPage, PostPage, MarketplacePage, Subsection/Section.

Добавить robots.txt и sitemap.xml.

Безопасность контента:

PostPage.tsx рендерит HTML через dangerouslySetInnerHTML без санитайзера — нужен DOMPurify.

Методичка:

Добавить якоря по каждому калькулятору, «Скачать методичку (PDF)», версионирование («актуально на …»).

Админ-панель (UX):

Много функций есть, но навигация неочевидна. Нужны: боковое меню «Секции/Подсекции/Посты/Объявления/Пользователи/Модерация/Медиа/Уведомления/Аналитика», везде фильтры и поиск, статусы/бейджи.

3) Соответствие НПА РК по реализованным калькуляторам (по коду)

Огнетушители — соответствует: минимум 2 на этаж; −50% при АУПТ; послабление для кат. Д ≤100 м²; рекомендации по колёсным ОТ при большой площади. Нужно лишь добавить явные ссылки на пункты ППБ/СТ в печатный отчёт.

НГПС — соответствует базовой логике (≥3500 м² + >3 км; обязательные отрасли). Рекомендую актуализировать список отраслей №1017 и уточнить подсказки ввода.

Пожарная нагрузка — ок: формула q=Σ(m·Q)/S; несколько материалов реализованы; диапазоны категорий есть. Добавить сквозную связь «рассчитал нагрузку → перейти к категории/эвакуации».

Эвакуация — база ок (6/8/10 мин, формулы). Нужно: норматив на расстояния (алерт), несколько выходов, явный алерт по <0,8 м.

Категория взрывопожароопасности — сейчас упрощённо; для нормативного соответствия требуется критерий ≥5 кПа → А, переработка блока ЛВЖ/ГЖ (учёт количества и условий нагрева), и корректные описания для Г/Д.

4) «Как сделать как на fireman.club (ГДЗС)» и «как в Fire Risk (визуализация)»
Паспорта расчёта (в духе fireman.club)

Для каждого калькулятора добавить в DOM отдельный блок Report (обёртка), куда выводятся:

цель, входные данные;

формулы с подстановкой чисел;

промежуточные результаты;

итог + обоснование и ссылки на НПА (пронумерованные, с якорями на методичку);

QR/ссылка на страницу расчёта.

Подключить print.css глобально (в client/src/main.tsx/index.css) и настроить разрывы страниц (page-break-before/after).

Нужна кнопка «Сохранить PDF»: быстрый вариант — window.print(); продвинутый — серверный рендер через puppeteer в /api/print (но это опционально).

Визуализация «как в Fire Risk»

Лёгкий 2D-редактор плана (без тяжёлой CAD):

Библиотека: Konva.js или Fabric.js; сущности: стены, двери/выходы, препятствия, источники, люди (spawn-зоны).

Автоматическая сетка путей и простая эвакуационная модель (graph/Dijkstra или cellular automata).

Тёпловая карта потока/узкие места; экспорт JSON + печать схемы в отчёт.

Риск-калькуляторы: оставить веб-уровень «предпроектных» оценок с дисклеймером (точные расчёты — проектным ПО).

Интеграция с внешними EXE (FireRisk/Pathfinder/PyroSim) невозможна напрямую в браузере и юридически сомнительна. Если потребуется, технически можно:

поднять Windows-инстанс с лицензией и обёртку-микросервисом (CLI), вызывать через очередь;

лучше — реплицировать формулы QRA/эвакуации/дымудаления по НПА РК и международным методикам в вашем TypeScript-ядре и честно пометить область применимости.

5) Что я не смог проверить на 100%

Я делал статический аудит кода. Я не запускал сервер/БД, поэтому UX-мелочи (например, конкретные тексты подсказок/валидации, фактические ответы API) могли ускользнуть.

Полный состав «обязательных отраслей» №1017 я в коде не сверял по документу — в NGPSCalculator.tsx список есть, но нужно сличить с НПА и дополнить.

Методика на странице есть и выглядит содержательно, но якорей PDF/скачиваний не увидел — нужно добавить.

6) Конкретные шаги (Backlog v1, по приоритету)

P0 (сразу)

Подключить client/src/components/ui/print.css глобально (в client/src/main.tsx или index.css).

Для всех 5 калькуляторов: унифицированный Report-блок («паспорт расчёта») с формулами, подстановками, обоснованием и ссылками-якорями на методичку; добавить кнопку Печать через PrintButton.

Эвакуация:

алерт при L > норматива по типу здания;

режим 2–3 выхода (распределение N, суммарная пропускная способность);

явный алерт при doorWidth < 0.8 м.

Категории: ввести расчёт давления (или эквивалентный нормативный критерий) и правило ≥5 кПа → А; корректно описывать Г/Д; добавить «Очистить всё».

SEO/индексация: подключить SEOHead на Post/Ad/Marketplace/Section/Subsection; сгенерировать robots.txt и sitemap.xml.

Безопасность: обернуть dangerouslySetInnerHTML в DOMPurify.

P1 (быстро следом)
7) NGPS: дополнить перечень MANDATORY_INDUSTRIES по №1017; подписи к полям (суммарная площадь А/Б/В; расстояние «по прямой»).
8) Calculators list: добавить карточку «Пожарная нагрузка» с ссылкой на /calculators/fire-load.
9) Методичка: якоря для каждого калькулятора + «Скачать PDF»; версия/дата актуальности.
10) Админ-панель UX: левое меню по разделам, везде фильтры/поиск/сортировки; бейджи статусов.

P2 (визуализация)
11) Прототип 2D-планировщика (Konva.js) с простым эвак-движком; вывод схемы в «паспорт».
12) Серверный экспорт в PDF (puppeteer) — опционально.